# 函数的凹凸性

## 定义

函数的凸（凹）性其实是由任意定比分点处的割线函数值与函数值大小关系定义的：
$$
f(tx_{1}+(1-t)x_{2})\leq tf(x_{1})+(1-t)f(x_{2}),\forall t\in(0,1)
$$
称上述函数为凸函数（下凸函数），凹函数只需要反号即可

上述定义方式其实也给出了二元形式的琴生不等式

## 斜率关系

对于凸函数来讲，任意选定某个参考点 $x_{0}$，由这个参考点发出的所有割线的斜率总是递增的，也即：
$$
\forall x_{1}<x_{2}, \frac{f(x_{1})-f(x_{0})}{x_{1}-x_{0}}< \frac{f(x_{2})-f(x_{0})}{x_{2}-x_{0}}
$$
注意到，这个 **参考点的选定是任意** 的，并且发出的所有割线与原函数的另一个交点选择也是任意的

这等价于：在凸函数开区间内，任意点的导数永远是递增的
$$
\forall x_{1}<x_{2},f'(x_{1})<f'(x_{2})
$$
### 两个命题的等价性

这两个命题的等价性并不是很 trivial。前一个推后一个是显然的，这是由拉格朗日中值定理保证的；但是后一个直接推前一个并不是很容易，因为在一般的函数中并不一定能够保证每一点的函数值都能够对应得上某个割线斜率。对这件事情给出如下例子：

>[!example] 反例
>给出如下反例$$f(x)=x^3,f'(0)=0,f''(0)=0,f'''(0)=6\neq 0$$可以看出，$x=0$ 是函数的拐点。由于这个函数是单调递增的，因此没有任何一条割线的斜率为零

但是断言，对于任意的凸（凹）函数，上述两个命题等价总是成立的。

### 加强：开区间上的凸（凹）函数任意点导数值总能等于某条割线斜率

此即需要证明命题如下：

>[!question] 命题
>设函数 $f$ 在 $(a,b)$ 可微，且在某一点 $x=\xi$ 处有 $f''(\xi)>0$，求证：$$\exists x_{1},x_{2}\in(a,b),s.t.\frac{f(x_{1})-f(x_{2})}{x_{1}-x_{2}}=f'(\xi)$$

这即是 [[微分中值定理#拉格朗日 (Lagrange) 中值定理]] 的逆定理

根据几何直观想象：

![[IMG-20251130135208196.jpeg]]

我们尝试给出这样的东西，使得某两点连线的割线斜率等于支撑线斜率。这即是要证明，我们能够给出两个点，使得他们的函数值减去支撑线的函数值相等。联想到介值定理，构造如下函数：

首先是支撑线函数：
$$
g(x)=f(\xi)+f'(\xi)(x-\xi)
$$
构造函数值与支撑线的差函数，有：
$$
F(x)=f(x)-g(x)
$$
我们希望证明这个东西不单调，也即：
$$
\exists c,s.t.F(x_{1})=F(x_{2})=c
$$
特殊注意到，$F(\xi)=f(\xi)-g(\xi)=0$，这显然是目前这个小邻域内的最小值。于是，我们只需要找出 $F(x)$ 在这个邻域内的两个正值即可。

考虑 $x_{2}>\xi$，有：
$$
F(x_{2})=f(x_{2})-g(x_{2})=f(x_{2})-f(\xi)-f'(\xi)(x_{2}-\xi)
$$
对 $f(x_{2})$ 在 $x=\xi$ 处展开，得到：
$$
f(x_{2})=f(\xi)+f'(\eta)(x_{2}-\xi),\eta\in(\xi,x_{2})
$$
代入上式中，得到：
$$
F(x_{2})=[f'(\eta)-f'(\xi)](x_{2}-\eta)>0
$$
这个东西大于零是由 $f''(\xi)>0$ 给出的。由于二阶可导，故必然至少存在小邻域一阶可导，且在该小邻域中一阶导函数单调递增。

另外一边的 $x_{1}<\xi$ 可以同理找到。

于是我们取：
$$
\varepsilon=\min\{F(x_{1}),F(x_{2})\},0<c<\varepsilon
$$
证毕

### 等价性另简证

事实上，不用如此复杂，可以绕过上述加强命题证明充分性：
$$
\impliedby \forall x_{1}<x_{2}<x_{3},\frac{f(x_{2})-f(x_{1})}{x_{2}-x_{1}}\leq\frac{f(x_{3})-f(x_{1})}{x_{3}-x_{1}}
$$
由拉格朗日中值定理，得到：
$$
\exists \eta_{1}<x_{2}<\eta_{2},s.t.f'(\eta_{1})=\frac{f(x_{2})-f(x_{1})}{x_{2}-x_{1}},f'(\eta_{2})=\frac{f(x_{3})-f(x_{1})}{x_{3}-x_{1}}
$$
而由一阶导的单调性，有：
$$
f'(\eta_{1})<f'(\eta_{2})
$$
于是证毕

这个证明绕过了直接将导函数值对应到割线斜率的步骤，得出了等价性

## 导数关系

### 不一定可导

需要指明的是，具有凸凹性并不代表一定处处可导，反例如下：

>[!example] 反例 1 
>$$f(x)=|x|$$

显然上述函数是凸的（当然并不是严格凸），但是在 $x=0$ 点不可导

进一步地，如果一个函数是严格凸的，是否意味着其一定处处可导呢？当然也不一定，可以进一步地举出如下反例：

>[!example] 反例 2
>$$f(x)=\begin{cases}x^2,&x<0\\x^2+x,&x\geq 0
\end{cases}$$

显然严格凸，并且在 $x=0$ 处不可导

### 但一定单侧可导

这也即，凸函数任意内点的任意一侧单侧导数必定存在

这是由任意割线斜率必定单调上升保证的。由于单调上升，又显然有上界，于是 [[单调收敛原理]] 告诉我们，其必定有单侧极限存在

### 若二阶可导

特别地，如果某函数在开区间上二阶可导，则其在这个区间上某点二阶导数的正负性直接决定了该点的凹凸性

## 支撑线与琴生不等式

>[!note] 定理：支撑线
>给定函数 $f(x)\in C[a,b]$，且 $f(x)$ 在 $[a,b]$ 可导，则有：$$f(x)\text{是凸函数} \iff \forall x_{0}\in(a,b),\forall x\in(a,b),f(x)\geq f(x_{0})+f'(x_{0})(x-x_{0})$$并称：$$y=f(x_{0})+f'(x_{0})(x-x_{0})$$为函数的一条支撑线

支撑线可以看成是一种特别的局部线性化的切线不等式，下面继续写割线不等式

>[!note] 定理：琴生 (Jensen) 不等式
>设 $f(x)$ 在 $[a,b]$ 上是凸函数，任取内部 $x_{1},x_{2},\dots,x_n\in[a,b]$，并对其做加权平均，权值分别为 $t_{1},t_{2},\dots,t_n$，其中 $\sum_{k=1}^nt_k=1$，且保证 $t_k>0,k=1,2,\dots,n$，则有：$$f\left( \sum_{i=1}^n x_it_i \right)\leq \sum_{i=1}^n t_if(x_i)$$

可以这样叙述：对于凸函数，自变量加权平均的函数值，小于等于函数值的加权平均

## 凸函数的最值

这应该有一部分是跟 [[Q 柯西下界与均值上界]] 的那个一起整理的，留着

### 凸函数的最大值必定取在端点

这是直观的。可以使用反证法证明。若不然，则有 $f(x_{0})>f(x),x_{0}\in[a,b],\forall x\in[a,b]$

则考察这个最大值点向其他点的连线。显然往左连的割线斜率一定是正的，往右连的割线斜率一定是负的，这与割线斜率递增矛盾

同理，凹函数的最小值必然取在端点