# 高阶导数

## 计算方式

### 莱布尼茨 (Leibniz) 公式：乘法的高阶导数

>[!note] 莱布尼茨 (Leibniz) 公式
>$$[u(x)v(x)]^{(n)}=\sum_{k=0}^{n}C_n^k u(x)^{(k)}v(x)^{(n-k)}$$

这跟二项式展开的形式非常类似，可以使用数学归纳法证明

## 特殊例子

### 例 1 幂函数的高阶导

>[!note] 例 1.1
>$$(x^\alpha)^{(n)}=\alpha (\alpha-1)(\alpha-2)\dots(\alpha-n+1)x^{\alpha-n}$$

特别地，对于 $(1+x)^\alpha$ 形式，有如下特殊例子：

>[!note] 例 1.2 
>$$\begin{align}&[(1+x)^{-1/2}]^{(n)}=\frac{(-1)^n(2n-1)!!}{2^n(1+x)^{1/2+n}}\\&[(1+x)^{-1}]^{(n)}=\frac{(-1)^nn!}{(1+x)^{n+1}}\end{align}$$

### 例 2 [[三角函数]] 的高阶导数

>[!note] 例 2
>$$\begin{align} 
(\sin x)^{(n)}=\sin(x+\frac{n\pi}{2}) \\ (\cos x)^{(n)}=\cos(x+\frac{n\pi}{2})
\end{align}$$

### 例 3 反三角函数的高阶导数

#### 反正切函数

##### 一般位置的高阶导数

>[!note] 例 3.1
>函数 $y=f(x)=\arctan x$，求：$f^{(n)}(x)$

首先不妨先考虑一阶导：
$$
y'=\frac{1}{1+x^2}=\cos^2y
$$
此为 **微分方程** 的形式。但是右侧是 **复合函数**。对于复合函数的高阶导数，我们没有什么特殊的方法直接求 n 阶导数。于是不妨先求二阶导，试探一下
$$
\begin{align}
y''&=2\cos y(-\sin y)y' \\
&=\cos^2y\sin [2(y+\frac{\pi}{2})]
\end{align}
$$
再来一个，求三阶导：
$$
\begin{align}
y^{(3)}&=-2(3\cos^2y\cdot(-\sin y) y'\cdot \sin y+\cos^4y\cdot y') \\
&=2(3\cos^4y\sin^2y-\cos^6y) \\
&=6\left( \cos^3y\cdot \sin\left[ 3\left( x+\frac{\pi}{2} \right) \right] \right)
\end{align}
$$
可以归纳证明：
$$
y^{(n)}(x)=(n-1)!\cos^ny\cdot \sin\left[ n\left( x+\frac{\pi}{2} \right) \right]
$$
##### 在 0 处的高阶导数

可以使用 [[Taylor 展开]] 来求解

#### 反正弦函数

>[!note] 例 3.2
>函数 $y=\arcsin x$，求函数在 $x=0$ 处的 $n$ 阶导数

##### 方法一：推导递推式

仍然不妨先求一阶导数试一试：
$$
y'=\frac{1}{\sqrt{ 1-x^2 }}
$$
整理之后，得到：
$$
y'\sqrt{ 1-x^2 }=1
$$
>[!question] 这里为什么不能直接求高阶导？
>形式不好。我们尝试求一下试试：$$\begin{align}LHS&=C_n^0y^{(n+1)}(\sqrt{ 1-x^2 })^{(n)}+\dots\end{align}$$算到这里就不用算了，我们根本不知道如何求既带类二项式幂函数，又带复合函数的东西的高阶导数
>换句话说，我们对于求高阶导，能够直接知道的只有如下几个形式：
>1. 干净的幂函数
>2. 干净的类二项式函数，不带复合函数
>3. 三角函数
>4. 指数函数
>
>这种能够化为微分方程形式的算是更加特殊的了

再次求二阶导数得到：
$$
y''\sqrt{ 1-x^2 }-y' \frac{x}{\sqrt{ 1-x^2 }}=0
$$
整理得到：
$$
y''(1-x^2)=y'x
$$
现在两边都是 **乘法**，于是可以使用莱布尼茨公式求高阶导，得到：
$$
\begin{align}
&LHS=y^{(n+2)}(1-x^2)-ny^{(n+1)}(2x)-n(n-1)y^{(n)} \\
&RHS=y^{(n+1)}x+ny^{(n)}
\end{align}
$$
由于是求在 $x=0$ 处的导数，于是令 $x=0$ 得到：
$$
\begin{align}
&LHS=y^{(n+2)}-n(n-1)y^{(n)} \\
&RHS=ny^{(n)}
\end{align}
$$
两边整理，得到递推关系：
$$
y^{(n+2)}=n^2y^{(n)}
$$
于是结合 $y(0)=0, y'(0)=1$ 得到：
$$
\begin{align}
&y^{(2k)}(0)=0 \\
&y^{(2k-1)}(0)=(2k-1)!!
\end{align}
$$

##### 方法二：使用 Taylor 展开反解

参看 [[Taylor 展开#反正弦函数在 $x=0$ 处的高阶导数]] 

#### 其他类似的情形

### 例 4 收敛半径为无穷的函数

>[!note] 例 4 
>设函数 $f(x)$ 为：$$f(x)=\begin{cases}e^{-1/x^2},&x\neq 0\\ 0,&x=0\end{cases}$$求证：$f^{(n)}(0)=0,\forall n\in \mathbb{N_+}$

显然有，该函数在 $x=0$ 点是连续的

断言：对于任意 $x\neq 0$ 处，任意阶导函数必然有如下形式：
$$
f^{(n)}(x)=P_n\left( \frac{1}{x} \right)e^{-1/x^2}
$$
证明：使用归纳法
对于 $n=0$ 显然成立
假设对于 $n$ 成立，考察 $n+1$ 阶导函数：
$$
\begin{align}
f^{(n+1)}(x) &= (f^{(n)}(x))' \\
&=\left( P_n\left( \frac{1}{x} \right)e^{-1/x^2} \right)'=P'_n\left( \frac{1}{x} \right)\left( -\frac{1}{x^2} \right)e^{-1/x^2}+P_n\left( \frac{1}{x} \right)\left( \frac{2}{x^3} \right)e^{-1/x^2} \\
&=P_{n+1}\left( \frac{1}{x} \right)e^{-1/x^2}
\end{align}
$$
故上述断言成立

于是考察在 $x=0$ 处的高阶导函数：
$$
\begin{align}
\lim_{ x \to 0 } \frac{f(x)-f(0)}{x-0}&=\lim_{ x \to 0 } \frac{f(x)}{x} \\
&=\lim_{ x \to 0 } P_n\left( \frac{1}{x} \right) \frac{e^{-1/x^2}}{x}=0
\end{align}
$$
证毕

