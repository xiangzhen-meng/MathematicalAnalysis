# 微分中值定理

## 概述

### 前提条件

三大中值定理的共有条件为：

**闭区间连续，开区间可导** 

尝试改变一下条件，看看是否可以。首先，必然要求至少开区间可导，否则中值的事情无从谈起。故下面依次说明：”开区间连续可导“，”闭区间连续可导“ 

#### 开区间连续可导行不行？

这也即去掉了 “闭区间连续” 的条件。开区间连续可导也即意味着：在区间的所有 **内点** 连续可导。但是这**并不能说明区间端点单侧连续可导**

可以给出第一类间断点（跃点）的例子：
$$
f(x)=\begin{cases}
x,&x\in[0,1) \\
0,&x=1
\end{cases}
$$
显然上述函数在开区间内连续，在开区间内可导，而不满足中值定理

#### 闭区间连续可导行不行？

这相当于加强了条件（减弱了定理），将开区间可导变为了闭区间可导。显然这样的函数也符合中值定理，但是有的函数符合中值定理，且开区间可导闭区间不可导

下面给出 **开区间可导而闭区间不可导** 的例子：
$$
f(x)=\sqrt{ x },x\in(0,1)
$$
这个函数显然在开区间可导，但是在闭区间不可导，因为在 0 处的导数为 $+\infty$ 

进一步地，给出 **开区间可导而闭区间不可导，且满足中值定理** 的例子
$$
f(x)=\begin{cases}
x\sin \dfrac{1}{x},&x\in(0, 1/\pi] \\
0,&x=0
\end{cases}
$$
显然有：这个函数在左右区间端点上都取值为 0，且在闭区间连续。考虑其在 0 处的导数如下：
$$
f'(0)=\lim_{ h \to 0}\frac{f(h)-f(0)}{h}=\lim_{ h \to 0 } \frac{h\sin \frac{1}{h}}{h}=\lim_{ h \to 0 } \sin \frac{1}{h} \not\exists
$$
因此 0 处的导数不存在，在闭区间上不可导。显然上述函数依然满足中值定理

## 罗尔中值定理

### 推广形式：无穷情形

>[!note] 推广形式：无穷情形
>设 $f$ 在 $[a,+\infty)$ 连续，在开区间上可导，且有：$\lim_{ x \to +\infty }f(x)=f(a)$
>求证：$\exists \xi>a,s.t.f'(\xi)=0$

#### 分析

不妨让函数一部分先增后减，也即 $\exists \eta,s.t.f(\eta)>f(a)$
由于在无穷处趋向于 $f(a)$，故而必然有一个值在 $f(a)$ 的上面一点点的位置，于是可以在这个区间内使用原来的罗尔中值定理

#### 证明

不妨假设 $\exists \eta>a,s.t.f(\eta)>f(a)$ ，则由介值性质，必然有：
$$
\exists \xi_{1},s.t.f(a)<f(\xi_{1})<f(\eta)
$$
另一方面，在无穷处，取定 $\varepsilon=f(\eta)-f(a)$，则由介值性质，必然存在：
$$
\exists \xi_{2}>\eta,s.t.f(\xi_{2})=f(\xi_{1})
$$
于是使用罗尔中值定理即可

## 拉格朗日 (Lagrange) 中值定理

### 概述

拉格朗日中值定理其实是在局部上利用 **线性手段** 控制函数，也即 **局部线性化** 

这是非常有力的控制手段，可以推出一个很强的工具：**有限增量公式** 

### 有限增量公式

$$
\Delta y=f'(\xi)\Delta x
$$
也即这个形式：
$$
f(x)=f(x_{0})+f'(\xi)(x-x_{0})
$$
对比 [[微分形式#无穷小增量公式]]，这个公式没有无穷小量，也即我们的估计是没有任何误差的。这是非常重要的！

另外，给出类似的有用的形式：
$$
f(x)=f(x_{0})+f'(x_{0}+\theta\Delta x)\Delta x,其中 \theta\in(0,1)
$$

在 [[Taylor 展开#带 Lagrange 余项的 Taylor 展开]] 中，给出了有限增量公式的加强版本，可以直接利用 n 阶微分中值对原函数进行估计

## 柯西中值定理

### 理解

一方面，可以将其理解成参量形式的拉格朗日中值定理。由于一阶微分的形式不变性，令拉格朗日中值定理中的自变量为参量，即得到上述定理。

另一方面，可以将其理解成类似于洛必达法则的形式，干一些类似于洛必达法则的事情。事实上，洛必达法则就是由柯西中值定理构造函数证明的。

### 适用条件

特别的，分式形式的柯西中值定理有适用条件：$g'(x)\neq 0$ 

改变形式的柯西中值定理，则有如下推广：
$$
f'(\xi)[g(b)-g(a)]=g'(\xi)[f(b)-f(a)]
$$
这样的函数 $g(x)$ 没有限制

## 例题

### 例子 1 待定常数法

待定常数法必须得有常数

也就是说，最后的形式必然得化为：$f'(\xi)=c$ 或者类似的东西。换句话讲，待定常数法无法处理类似于 $f'(\xi)+f(\xi)=c$ 的结构，也即不能让原函数和导函数同时出现

这篇 [知乎文章](https://zhuanlan.zhihu.com/p/31267451) 好像写的不错

>[!question] 例子 1 待定常数法
>给定函数 $f(x)$ 在 $[a,b]$ 上二阶可导，且满足：$f(a)=f(b)=0$，求证：$$\forall x\in(a,b),\exists \xi\in(a,b),s.t.f(x)=\frac{f''(\xi)}{2}(x-a)(x-b)$$

#### 方法一：待定常数法

通常来讲，固定 $x$，需要把中值部分单独扔到一边，常数部分单独扔到一边，于是有：
$$
f''(\xi)=\frac{2f(x)}{(x-a)(x-b)}:=\lambda
$$
这也就意味着，需要构造某个函数 $F(x)$ ，使得：$F(a)=F(b)=0$
并且显然需要 $F(x)$ 满足其二阶导有如下形式：
$$
F''(\xi)=0=f''(\xi)-\frac{2f(x)}{(x-a)(x-b)}=f''(\xi)-\lambda
$$
这样的话，所要构造的函数就大概确定下来了，注意此时函数里的变量是 $t$，而不是 $x$，因为我们此时固定下了 $x$，将其视作已知。

然后想要构造合适的函数。注意到我们现在已经有了函数的二阶导数。显然 $\lambda$ 应该是二次项系数，因此尝试：
$$
F(t)=f(t)-\lambda t^2
$$
好像不行，因为这个东西不能在 $F(a)=F(b)=0$，于是加上这个限制：
$$
f(a)=\frac{2f(x)}{(x-a)(x-b)}P_{2}(a)
$$
同理，对于 b 处有：
$$
f(b)=\frac{2f(x)}{(x-a)(x-b)}P_{2}(b)
$$
显然可以构造：
$$
P_{2}(t)=(t-a)(t-b)
$$
分别在 a 和 b 处有两个根，则有：
$$
F(t)=f(t)-\lambda(t-a)(t-b)
$$
成功，对其使用罗尔中值定理即可，证毕

#### 方法二：柯西中值定理

直接柯西中值，得到：
$$
\exists \eta_{1}\in(a,(a+b)/2),s.t.\frac{2f(x)}{(x-a)(x-b)}=\frac{f'(\eta_{1})}{\eta_{1}-(a+b)/2}
$$
同理，得到：
$$
\exists \eta_{2}\in((a+b)/2,b),s.t.\frac{2f(x)}{(x-a)(x-b)}=\frac{f'(\eta_{2})}{\eta_{2}-(a+b)/2}
$$
这样的话，相当于是找到了一阶导的两个相等的点，把右面对着减一下，得到：
$$
\frac{2f(x)}{(x-a)(x-b)}=\frac{f'(\eta_{2})-f'(\eta_{1})}{\eta_{2}-\eta_{1}}
$$
右面即是某一点的二阶导数

### 例子 2 Legendre 多项式

>[!question] 例子 2 Legendre 多项式的实根
>求证：Legendre 多项式 $P_n(x)=\frac{1}{2^nn!}[(x^2-1)^n]^{(n)}$ 在 $(-1,1)$ 内有 n 个不等的实根

其实只需要证明 $[(x^2-1)^n]^{(n)}$ 在 $(-1,1)$ 有 n 个不等实根即可。既然在中值定理这一章节，不妨考虑中值定理解决：

首先，函数 $f(x)=(x^2-1)^n$ 有两个 n 重实根：-1 和 1，则由罗尔中值定理，有：
$$
\exists f'(\xi_{11})=0
$$
考虑区间：$(-1,\xi_{11})$ 和 $(\xi_{11},1)$，在这两个区间上分别继续使用罗尔中值定理，有：
$$
\exists \xi_{21},\xi_{22},f''(\xi_{21})=f''(\xi_{22})=0
$$
依此续行，最终得到：
$$
f^{(n)}(\xi_{n_{1}})=\dots=f^{(n)}(\xi_{nn})=0
$$
证毕

### 例 3 ODE 方法

>[!question] 例 3 
>给定 $f(x)\in C[0,1]\bigcap D(0,1)$ 常数 $a>0$ 且有 $f(a)=0$，求证：$$\exists \xi\in(a,b),s.t.f(\xi)=\frac{b-\xi}{a}f'(\xi)$$

这种就是属于待定常数法干不了的，或者说至少是不能直接干的事情。既有原函数又有导函数，这就意味着必须要配凑出来一种积分的形式

将原等式分离参数，得到：
$$
\frac{f'(x)}{f(x)}=\frac{a}{b-x}
$$
对其两边同时找原函数，得到：
$$
\frac{d}{dx}\ln f(x)=\frac{d}{dx}[a\ln(x-b)]
$$
整理一下，得到：
$$
\frac{d}{dx}\ln[(x-b)^af(x)]=0
$$
则取原函数为：
$$
F(x)=\ln[(x-b)^af(x)]
$$
满足：
$$
F(a)=F(b)=0
$$
则由罗尔中值定理推出：
$$
F'(\xi)=0
$$
成立，证毕
$$

$$