# 不定积分

## 不定积分表

### 三角函数类

#### 三角函数本身积分
$$
\begin{align}
\int \sin x\ dx&=-\cos x+C \\
\int \cos x\ dx&=\sin x+C \\
\int \tan x\ dx&=-\ln|\cos x|+C=\ln|\sec x|+C  \\
\int \cot x\ dx&=\ln|\sin x|+C \\
\int \sec x\ dx&=\ln|\sec x+\tan x|+C \\
\int \csc x\ dx&=\ln|\csc x-\cot x|+C \\
\end{align}
$$
#### 特殊三角函数形式的积分

其中，前两条只要记住 $\sec x$ 和 $\csc x$ 的导数；中间两条主要注意的是符号不一样；最后两条不用硬背，记住系数不同即可
$$
\begin{align}
\int \sec x\tan x\ dx&= \sec x +C\\ 
\int \csc x\cot x\ dx&=-\csc x+C \\ 
\int \sec^2 x\ dx=&\tan x+C \\
\int \csc^2x\ dx=&-\cot x+C \\
\int \sin^2x\ dx=&\frac{1}{2}x-\frac{1}{4}\sin 2x + C \\
\int \cos^2x\ dx=&\frac{1}{2}x+\frac{1}{4}\sin 2x + C
\end{align}
$$

#### 积分后为反三角函数的
$$
\begin{align}
\int \frac{dx}{x^2+a^2}&=\frac{1}{a}\arctan \frac{x}{a}+C \\
\int \frac{dx}{\sqrt{ a^2-x^2 }}&=\arcsin \frac{x}{a}+C \\
\int \frac{dx}{\sqrt{ x^2\pm a^2 }}&=\ln\left|x+\sqrt{ x^2\pm a^2}\right|
\end{align}
$$
注意到第三条不是反三角函数类的（应归于根式类），但是写在这里，主要是避免混淆

### 根式类
$$
\begin{align}
\int \sqrt{ x^2-a^2 }\ dx&=\frac{x}{2}\sqrt{ x^2-a^2 }-\frac{a^2}{2}\ln|x+\sqrt{ x^2-a^2 }|+C \\
\int \sqrt{ x^2+a^2 }\ dx&=\frac{x}{2}\sqrt{ x^2+a^2 }+\frac{a^2}{2}\ln|x+\sqrt{ x^2+a^2 }|+C \\
\int \sqrt{ a^2-x^2 }\ dx&=\frac{x}{2}\sqrt{ a^2-x^2 }-\frac{a^2}{2}\arcsin \frac{x}{a}+C
\end{align}
$$
1. 所有的根式里面的东西都是照抄原式的
2. 三个东西第一项都是相同的
3. 第二项的，反三角型的是反三角，根式相加型的带 $\ln$ 

## 几个特殊形式的不定积分

### 例 1 分母二次可因式分解的类型
$$
\int\frac{1}{(x-a)(x-b)}=\frac{1}{a-b}\ln \left| \frac{x-a}{x-b} \right| +C
$$
这个只需要把其拆成和的形式即可，需要注意的是符号的问题。注意每次做积分的时候尽量把 $x-a$ 的系数调成正的，以免正负号搞反

### 例 2 反正切和反正弦以及类似形式
$$
\int \frac{dx}{x^2+a^2}=\frac{1}{a}\arctan \frac{x}{a}+C
$$
这个是一般的反正切形式，前面 **有个系数** 需要注意
$$
\int \frac{dx}{\sqrt{ a^2-x^2 }}=\arcsin \frac{x}{a}+C
$$
这个是一般的反正弦形式，需要注意的是 **前面没有系数** 

另外，需要注意的是反正弦形式分母的减法调换位置之后会积出来一坨：
$$
\int \frac{dx}{\sqrt{ x^2\pm a^2 }}=\ln\left|x+\sqrt{ x^2\pm a^2 }\right|+C
$$
注意到根号外面的那个符号永远为正号。这个东西的推导需要三角换元第二换元法：

令：$x=a\sec t$ 则有：
$$
\begin{align}
\int \frac{dx}{\sqrt{ x^2-a^2 }}&=\int \frac{d(a\sec t)}{a\tan t} \\
&=\int\frac{a\frac{\sin t}{\cos^2t}dt}{a\frac{\sin t}{\cos t}} \\
&=\int \frac{1}{\cos t}dt \\
&=\ln \left| \frac{1+\sin t}{\cos t} \right| +C \\
&=\ln \left| \frac{1+\sqrt{ 1-a^2/x^2 }}{a/x} \right|+C \\
&=\ln \left| x+ \sqrt{ x^2-a^2 }\right| +C'
\end{align}
$$
注意，最后其实是把 $-\ln a$ 扔到 $C$ 里面了

### 例 3 常见的三角函数变式积分

$$
\int \tan x \ dx=-\ln|\cos x|+C
$$
正弦的和余弦的都很显然，正切的需要用到第一换元法，也即：
$$
\int \tan x\ dx=\int \frac{\sin x\ dx}{\cos x}=\int \frac{-d\cos x}{\cos x}=-\ln|\cos x|+C
$$
$$
\int \frac{1}{\cos x}dx=\ln \left| \frac{1+\sin x}{\cos x} \right| +C
$$
这个东西的推导需要用第一换元法做

$$
\begin{align} 
\int \sec xdx&=\int \frac{1}{\cos x}dx \\
&=\int \frac{1}{\cos^2 x}\cos xdx \\
&=\int \frac{1}{1-\sin^2x}d\sin x \\
&=-\int \frac{1}{(\sin x-1)(\sin x+1)}d\sin x \\
&=\frac{1}{2}\ln \left| \frac{\sin x+1}{\sin x-1} \right| +C \\
&=\ln \left| \frac{\sin x+1}{\cos x} \right| +C \\
&=\ln|\sec x+\tan x|+C
\end{align}
$$
关于第二换元法的操作要领：如何想到三角换元换哪个？画三角形

### 例 4 根式相关的

$$
\int \sqrt{ a^2-x^2 }\ dx
$$
这个东西使用三角换元即可，相对比较容易，令 $x=a\cos t$，得到：
$$
\begin{align}
\int \sqrt{ a^2-x^2 }\ dx&=\int \sqrt{ a^2-a^2\cos^2t }\ \text{d}(a\cos t) \\
&=a^2\int \sin^2 t\ \text{d}t \\
&=\frac{x}{2}\sqrt{ a^2-x^2 }-\frac{a^2}{2}\arccos \frac{x}{a}+C
\end{align}
$$
但是把符号前后换一下，就复杂的多了，也即：
$$
\int \sqrt{ x^2-a^2 }\ dx
$$
这个有两种方法：

**方法一：分部积分** 

这个积分有点技巧。任意函数的原函数都可以当作是乘以一个 $(x)'$ ，于是对其使用分部积分，得到：
$$
\begin{align}
I=\int \sqrt{ x^2-a^2 }\ dx&=x\sqrt{ x^2-a^2 }-\int xd\sqrt{ x^2-a^2  } \\
&=x\sqrt{ x^2-a^2 }-\int \frac{x^2-a^2+a^2}{\sqrt{ x^2-a^2 }}dx \\
&=x\sqrt{ x^2-a^2 }-\left( \int \sqrt{ x^2-a^2 }dx \right)-a^2\int \frac{1}{\sqrt{ x^2-a^2 }}dx \\
&=x\sqrt{ x^2-a^2 }-a^2\ln|x+\sqrt{ x^2-a^2 }|-I
\end{align}
$$
然后把 $I$ 挪到左边去，得到：
$$
I=\frac{1}{2}x\sqrt{ x^2-a^2 }-\frac{a^2}{2}\ln|x+\sqrt{ x^2-a^2 }|+C
$$
需要说明的是，如果把 $\sqrt{ x^2-a^2 }$ 换成 $\sqrt{ x^2+a^2 }$，只需要把中间项整体的正负号调换，然后根式里面的照抄即可，也即：
$$
\int \sqrt{ x^2+a^2 }\ dx=\frac{1}{2}x\sqrt{ x^2+a^2 }+\frac{a^2}{2}\ln|x+\sqrt{ x^2+a^2 }|+C
$$

**方法二：三角换元** 

这部分如果做三角换元是比较麻烦的，但是可做。只要令：
$$
x=\frac{a}{\cos t}=a\sec t
$$
则有：
$$
\begin{align}
\int \sqrt{ x^2-a^2 }\ dx&=\int \sqrt{ a^2\sec^2t-a^2 }\ \text{d}(a\sec t) \\
&=\int a\tan t\cdot a\tan t\sec t\cdot dt \\
&=a^2\int \tan^2t\sec tdt \\
&=a^2\int(\sec^2t-1)\sec tdt \\
&=a^2\left(\int \sec^3tdt-\int \sec tdt  \right)
\end{align}
$$
则下面只需要求出两个积分部分即可，于是有：
$$
\begin{align}
I=\int \sec^3tdt&=\int \sec^2t\cdot \sec tdt \\
&=\int \sec t\ d\tan t \\
&=\sec t\tan t-\int \tan t\ d\sec t \\
&=\sec t\tan t-\int \tan^2 t\sec t\ dt \\
&=\sec t\tan t-\int (\sec^2t-1) \sec t\ dt  \\
&=\sec t\tan t-\int \sec^3t\ dt+\int \sec t\ dt \\
&=\sec t\tan t-I+\ln \left| \sec t+\tan t \right| 
\end{align}
$$
这构造出来了一组循环式，于是解得：
$$
I=\frac{1}{2}\sec t\tan t+\frac{1}{2}\ln \left| \tan t+\sec t \right| +C
$$
则原式等于：
$$
\begin{align}
\int \sqrt{ x^2-a^2 }\ dx&=a^2\left( \frac{1}{2}\sec t\tan t+\frac{1}{2}\ln \left| \tan t+\sec t \right|-\ln|\sec t+\tan t| \right)+C_{1} \\
&= \frac{a^2}{2}\sec t\tan t-\frac{a^2}{2}\ln \left| \tan t+\sec t \right|+C_{1}
\end{align}
$$
然后带回到原式，其中：
$$
\sec t=\frac{x}{a},\tan t=\sqrt{ \sec ^2t-1 }=\sqrt{ \frac{x^2}{a^2}-1 }=\frac{\sqrt{ x^2-a^2 }}{a}
$$
则有：
$$
\begin{align}
RHS&=\frac{a^2}{2} \frac{x}{a} \frac{\sqrt{ x^2-a^2 }}{a}-\frac{a^2}{2}\ln| \frac{x}{a}+\frac{\sqrt{ x^2-a^2 }}{a}|+C_{1} \\
&=\frac{1}{2}x\sqrt{ x^2-a^2 }-\frac{a^2}{2}\ln \left| x+\sqrt{ x^2-a^2 } \right| +C
\end{align}
$$
**记忆方式**：
放在一起去记忆：
$$
\begin{align}
\int \sqrt{ x^2-a^2 }\ dx&=\frac{x}{2}\sqrt{ x^2-a^2 }-\frac{a^2}{2}\ln|x+\sqrt{ x^2-a^2 }|+C \\
\int \sqrt{ x^2+a^2 }\ dx&=\frac{x}{2}\sqrt{ x^2+a^2 }+\frac{a^2}{2}\ln|x+\sqrt{ x^2+a^2 }|+C \\
\int \sqrt{ a^2-x^2 }\ dx&=\frac{x}{2}\sqrt{ a^2-x^2 }-\frac{a^2}{2}\arcsin \frac{x}{a}+C
\end{align}
$$
1. 所有的根式里面的东西都是照抄原式的
2. 三个东西第一项都是相同的
3. 第二项的，反三角型的是反三角，根式相加型的带 $\ln$ 

### 例 5 一个特殊的有理分式的不定积分

>[!question] 例 5 求不定积分
>$$\int \frac{1}{(1+x^2)^2}dx$$

这个东西是个有理分式，必然可以分解成能够积分的形式，但是实在是比较复杂，留作第二个方法去写。事实上，由于其形式的特殊性（与反正切函数有关），可以使用如下策略，也即使用特殊的分部积分的方法

#### 方法一：反三角换元 + 分部积分
$$
\int \frac{1}{(1+x^2)^2}dx=\int \frac{1}{1+x^2}d\arctan x
$$
记：$\arctan x=u$，则有：
$$
\begin{align}
RHS&=\int\frac{1}{1+\tan^2 u}du \\
&=\int \cos^2u\ du \\
&=\frac{1}{2}\int (1+\cos 2u)du \\
&=\frac{1}{2}\left( u+\frac{1}{2}\sin 2u \right)+C
\end{align}
$$
再次把 $x=\tan u$ 代入进去，得到：
$$
RHS=\frac{1}{2}\arctan x+ \frac{1}{4} \frac{2x}{1+x^2} + C
$$
这即是：
$$
\int \frac{1}{(1+x^2)^2}dx=\frac{1}{2}\arctan x+ \frac{1}{2} \frac{x}{1+x^2} + C
$$
#### 方法二：使用有理根式的分解

事实上，原来的有理根式可以做如下分解：
$$
\frac{1}{(1+x^2)^2}= \frac{1}{1+x}+\frac{1}{(1+x)^2} + \frac{1}{1-x} + \frac{1}{(1-x)^2}
$$
于是，对其积分，得到：
$$
\begin{align}
\int \frac{1}{(1+x^2)^2}dx&=\frac{1}{4}\left( \ln|1+x|-\ln|1-x|-\frac{1}{1+x}+\frac{1}{1-x} \right)+C \\
&=\frac{1}{4}\left( \ln \left| \frac{1+x}{1-x} \right|+ \frac{1}{2}\frac{x}{(1-x^2)}  \right)+C
\end{align}
$$
这显然是对的，对右侧求导可以验证