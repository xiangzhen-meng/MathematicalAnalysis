# Taylor 展开

## 概述

Taylor 展开给出了用多项式逼近函数的手段

## 带 Lagrange 余项的 Taylor 展开

### 概述

Lagrange 余项相当于对 Peano 余项进行了定量的描述。虽然在其中仍然含有一个不确定的中值，但是只需要对中值进行估计，就可以达到对整个函数进行估计的效果

另外，此即 [[微分中值定理#有限增量公式]] 的加强版：
$$
f(x)=P_n(x;x_{0})+\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_{0})^{n+1}
$$
类似于有限增量公式，泰勒展开同样有这样类似的形式：
$$
f(x)=P_n(x;x_{0})+\frac{f^{(n)}(x_{0}+\theta\Delta x)}{n!}(\Delta x)^{n},\theta\in (0,1)
$$
对于这样形式的更深入的理解，参看 [[Q 通过 Taylor 展开理解中值定理的参数形式]] 

## 理解

### 实解析函数

>[!question] 问题
>如果函数在某点的任意阶泰勒展开多项式均为 0 ，能否推出 $f(x)\equiv 0$？

这是不可以的。给出例子：
[[高阶导数#例 4 收敛半径为无穷的函数]] 
$$f(x)=\begin{cases}e^{-1/x^2},&x\neq 0\\ 0,&x=0\end{cases}$$
上述函数在 $x=0$ 处的任意高阶导数都为零，于是必有其任意阶泰勒展开多项式为零，但是显然这个函数不恒等于零

给出定义：解析函数是指 Lagrange 余项趋于零的函数。上面的函数就是无穷阶可导，然而拉格朗日余项不收敛的函数，也即它不是解析函数

## 应用 1：逼近函数

### 例 1 需要记忆的几个常用逼近

**注意，以下全部都是在 $x=0$ 处展开的泰勒公式（写成 Peano 余项的形式）！！！**

首先有 $e^x$ 的展开式：
$$
e^x=1+x+\frac{1}{2}x^2+\frac{1}{3!}x^3+\dots+\frac{1}{n!}x^n+o(x^n)
$$
$\sin x$ 取偶数项，正负颠倒；$\cos x$ 取奇数项，正负颠倒
写成通项的形式，则是：
$$
\sin x=x-\frac{x^3}{3!}+\frac{x^5}{5!}-\frac{x^7}{7!}+\dots+\frac{(-1)^n}{(2n-1)!}x^{2n-1}+o(x^{2n})$$
$$
\cos x=1-\frac{x^2}{2!}+\frac{x^4}{4!}-\frac{x^6}{6!}+\dots+\frac{(-1)^n}{(2n)!}x^{2n}+o(x^{2n+1})
$$
自然对数：
$$
\ln (1+x)=x-\frac{x^2}{2}+\frac{x^3}{3}+\dots+\frac{x^n}{n}+o(x^n)
$$
类似二项式定理的形式：
$$
(1+x)^\alpha=1+\alpha x+\frac{\alpha(\alpha-1)}{2}x^2+\frac{\alpha(\alpha-1)(\alpha-2)}{3!}x^3+\dots+C_\alpha^nx^n+o(x^n)
$$
系数其实就是广义的二项式系数

反正弦：
$$
\arcsin x=x+\frac{1}{6}x^3+\frac{3!!}{4!!\cdot 5}x^5+o(x^6)
$$
反余弦，利用反正弦减一下即可：
$$
\arccos x=\frac{\pi}{2}-\arcsin x
$$
正切与反正切：
$$
\tan x=x+\frac{1}{3}x^3+o(x^4)
$$
$$
\arctan x=x-\frac{1}{3}x^3+\frac{1}{5}x^5
-\frac{1}{7}x^7+\dots+\frac{(-1)^n}{2n+1}x^{2n+1}+o(x^{2n+1})$$
### 重要的引理：导函数展开与原函数展开之间的关系

#### 理解

假设已知一个导函数是多项式的形式，比如说：
$$
f'(x)=a_{0}+a_{1}x+a_{2}x^2+\dots+a_nx^n
$$
我们尝试把它积回去，得到：
$$
f(x)=a_{0}x+\frac{1}{2}a_{1}x^2+\frac{1}{3}a_{2}x^3+\dots+\frac{1}{n+1}a_nx^{n+1}+C
$$
通常来讲，我们无法确定这个常数 $C$。但是对于泰勒展开，我们可以确保这个 $C$ 是唯一的，并且确定这个 $C$ 的值（即等于 $f(x_{0})$）

这就意味着，如果一个原函数的泰勒展开不好求解，我们可以求解其导函数在那一点的展开，进而积回原函数，然后找一下常数即可

#### 证明

只需要把原函数和导函数的泰勒展开写出来即可：
$$
f(x)=f(x_{0})+f'(x_{0})(x-x_{0})+\frac{f''(x_{0})}{2!}(x-x_{0})^2+\dots+\frac{f^{(n)}(x_{0})}{n!}(x-x_{0})^n+o((x-x_{0})^n)
$$
另一方面，导函数的展开：
$$
f'(x)=f'(x_{0})+f''(x_{0})(x-x_{0})+\frac{f^{(3)}(x_{0})}{2!}(x-x_{0})^2+\dots+\frac{f^{(n)}(x_{0})}{(n-1)!}(x-x_{0})^n+o((x-x_{0})^n)
$$
对比一下系数，不妨设导函数每一项的系数为 $a_i,i=1,2,3\dots n$ 则有：
$$
f(x)=f(x_{0})+a_{1}(x-x_{0})+\frac{a_{2}}{2}(x-x_{0})^2+\frac{a_{3}}{3}(x-x_{0})^3+\dots+\frac{a_n}{n}(x-x_{0})^n+o((x-x_{0})^n)
$$
证毕

### 例 2 二项式形式的展开

>[!note] 引理：二项式形式展开
>$$(1+x)^\alpha=1+\alpha x+\frac{\alpha(\alpha-1)}{2}x^2+\frac{\alpha(\alpha-1)(\alpha-2)}{3!}x^3+\dots+C_\alpha^nx^n+o(x^n)$$

上述式子是在 $x=0$ 处的泰勒展开，于是以下均考察 $x=0$ 处的展开

#### 反正切函数的展开

首先，取 $\alpha=-1$，得到：
$$
\begin{align}
(1+x)^{-1}&=1-x+\frac{2!}{2!}x^2-\frac{3!}{3!}x^3+\dots+(-1)^n\frac{n!}{n!}x^n+o(x^n) \\
&=1-x+x^2-x^3+\dots+(-1)^n x^n+o(x^n)
\end{align}
$$
从另一方面看，这也可看作等比数列的求和形式

置 $x$ 为 $x^2$ ，得到：
$$
(1+x^2)^{-1}=1-x^2+x^4-x^6+\dots+(-1)^n x^{2n}+o(x^{2n})
$$
回头再看反正切函数的一阶导数，
$$
(\arctan x)'=\frac{1}{1+x^2}
$$
可以知道，反正切函数的一阶导数可以写成如上形式的泰勒展开式，则由引理，可以把它直接积回去，得到：
$$
\arctan x=x-\frac{x^3}{3}+\frac{x^5}{5}-\frac{x^7}{7}+\dots+(-1)^n\frac{x^{2n+1}}{2n+1}+o(x^{2n+1})
$$
#### 反正弦函数的展开

由于：
$$
(\arcsin x)'=\frac{1}{\sqrt{ 1-x^2 }}=(1-x^2)^{-1/2}
$$
于是可以令上述 $\alpha=-1/2$，得到：
$$
\begin{align}
(1+x)^{-1/2}=&1-\frac{1}{2} x+\frac{\left( -\frac{1}{2} \right)\left( -\frac{3}{2} \right)}{2!}x^2+\frac{\left( -\frac{1}{2} \right)\left( -\frac{3}{2} \right)\left( -\frac{5}{2} \right)}{3!}x^3+\dots \\
&+\frac{\left( -\frac{1}{2} \right)\left( -\frac{3}{2} \right)\left( -\frac{5}{2} \right)\dots \left( -\frac{2n-1}{2} \right) }{n!}x^n+o(x^n) \\
=&1-\frac{1}{2}x+\frac{3}{8}x^2-\frac{5}{16}x^3+\dots+(-1)^n\frac{(2n-1)!!}{2^nn!}x^n+o(x^n)
\end{align}
$$
接下来，令上述 $x$ 为 $-x^2$，得到：
$$
(1+x^2)^{-1/2}=1+\frac{1}{2}x^2+\frac{3}{8}x^4+\frac{5}{16}x^6+\dots+\frac{(2n-1)!!}{2^nn!}x^{2n}+o(x^{2n})

$$
其中每一项的通项有更好看一些的形式：
$$
\frac{(2n-1)!!}{(2n)!!}x^{2n}
$$
把它积回去，可以知道原函数每一个单项的通项是：
$$
\frac{1}{2n+1}\frac{(2n-1)!!}{(2n)!!}x^{2n+1}
$$
然后就完事了，简单整理一下前几项，写出数来：
$$
\arcsin x=x+\frac{1}{6}x^3+\frac{3!!}{4!!\cdot 5}x^5+\dots+\frac{1}{2n+1}\frac{(2n-1)!!}{(2n)!!}x^{2n+1}+o(x^{2n+1})
$$
#### 反余弦函数

利用 [[三角函数#同角反三角函数之间的关系]] 可以知道，当 $x\in[-1,1]$ 时有：
$$
\arccos x=\frac{\pi}{2}-\arcsin x
$$
直接写出来泰勒了

### 由泰勒公式反推在某一点的高阶导数

#### 理解

泰勒展开的每一个单项系数都是：
$$
\frac{f^{(n)}(x_{0})}{n!}
$$
于是只要用某种方式确定一个函数的展开式，就可以反推出其在某一点的高阶导数

#### 反正切函数在 $x=0$ 处的高阶导数

展开的通项如下：
$$
\frac{x^{2n+1}}{2n+1}=\frac{f^{(2n+1)}(0)}{(2n+1)!}x^{2n+1}
$$
于是，反正切函数在 $x=0$ 处的 $2n+1$ 阶导数为：
$$
f^{(2n+1)}(0)=(2n)!
$$
在 $x=0$ 处的 $2n$ 阶导数为：
$$
f^{(2n)}(0)=0
$$
#### 反正弦函数在 $x=0$ 处的高阶导数

展开的通项如下：
$$
\frac{1}{2n+1}\frac{(2n-1)!!}{(2n)!!}x^{2n+1}=\frac{f^{(2n+1)}(0)}{(2n+1)!}x^{2n+1}
$$
整理得：
$$
f^{(2n+1)}(0)=[(2n-1)!!]^2
$$
对于偶数项，有：
$$
f^{(2n)}(0)=0
$$
对于最开始的那一项，也即：
$$
f'(0)=1
$$
